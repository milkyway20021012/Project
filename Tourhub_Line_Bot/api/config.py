# æ¶ˆæ¯æ¨¡æ¿é…ç½®
MESSAGE_TEMPLATES = {
    "reminder": {
        "10_min_before": {
            "emoji": "â°",
            "title": "é›†åˆæé†’",
            "message": "é‚„æœ‰ 10 åˆ†é˜å°±è¦é›†åˆäº†ï¼",
            "color": "#F39C12"
        },
        "5_min_before": {
            "emoji": "ğŸš¨",
            "title": "ç·Šæ€¥æé†’",
            "message": "é‚„æœ‰ 5 åˆ†é˜å°±è¦é›†åˆäº†ï¼",
            "color": "#E74C3C"
        },
        "on_time": {
            "emoji": "ğŸ¯",
            "title": "é›†åˆæ™‚é–“åˆ°äº†ï¼",
            "message": "é›†åˆæ™‚é–“åˆ°äº†ï¼è«‹æº–æ™‚åˆ°é”ï¼",
            "color": "#E74C3C"
        }
    },
    "features": {
        "leaderboard": {
            "title": "ğŸ† æ’è¡Œæ¦œ",
            "description": "æŸ¥çœ‹æœ€æ–°çš„æ’è¡Œæ¦œ",
            "sub_description": "é»æ“Šä¸‹æ–¹æŒ‰éˆ•æŸ¥çœ‹è©³ç´°æ’å",
            "button_text": "æŸ¥çœ‹æ’è¡Œæ¦œ",
            "color": "#FF6B6B",
            "url": "https://tourhub-ashy.vercel.app/?state=n6sFheuU2eAl&liffClientId=2007678368&liffRedirectUri=https%3A%2F%2Ftourhub-ashy.vercel.app%2F&code=DJhtwXyqmCdyhnBlGs3s"
        },
        "trip_management": {
            "title": "ğŸ—“ï¸ è¡Œç¨‹ç®¡ç†",
            "description": "å»ºç«‹å±¬æ–¼æ‚¨çš„å°ˆå±¬è¡Œç¨‹å…§å®¹",
            "sub_description": "é»æ“Šä¸‹æ–¹æŒ‰éˆ•é–‹å§‹è¦åŠƒæ‚¨çš„å®Œç¾æ—…ç¨‹",
            "button_text": "ç®¡ç†è¡Œç¨‹",
            "color": "#4ECDC4",
            "url": "https://tripfrontend.vercel.app/linetrip"
        },
        "locker": {
            "title": "ğŸ›… ç½®ç‰©æ«ƒ",
            "description": "å¿«é€Ÿå®šä½é™„è¿‘æœ‰ç©ºä½çš„ç½®ç‰©æ«ƒ",
            "sub_description": "è¼•é¬†å¯„å­˜è¡Œæï¼Œè®“æ‚¨çš„æ—…ç¨‹æ›´è¼•é¬†",
            "button_text": "å°‹æ‰¾ç½®ç‰©æ«ƒ",
            "color": "#FFA500",
            "url": "https://tripfrontend.vercel.app/linelocker"
        },
        "split_bill": {
            "title": "ğŸ’° åˆ†å¸³å·¥å…·",
            "description": "è¨˜éŒ„æ¯ä¸€ç­†è²»ç”¨ï¼Œè‡ªå‹•è¨ˆç®—æ¯äººæ‡‰ä»˜é‡‘é¡",
            "sub_description": "è¼•é¬†åˆ†æ”¤æ—…è²»ï¼Œé¿å…å°·å°¬çš„ç®—å¸³æ™‚åˆ»",
            "button_text": "é–‹å§‹åˆ†å¸³",
            "color": "#28A745",
            "url": "https://liff.line.me/2007317887-Dq8Rorg5"
        },
        "tourclock": {
            "title": "â° TourClock",
            "description": "æ™ºèƒ½é›†åˆæ™‚é–“ç®¡ç†å·¥å…·",
            "sub_description": "è¨­å®šé›†åˆæ™‚é–“ï¼Œè‡ªå‹•ç™¼é€æé†’é€šçŸ¥",
            "button_text": "é–‹å•Ÿ TourClock",
            "color": "#9B59B6",
            "url": "https://tourclock.vercel.app"
        }
    },
    "meeting_success": {
        "title": "ğŸ“ é›†åˆè¨­å®šæˆåŠŸ",
        "color": "#9B59B6",
        "status_success": "å·²åŒæ­¥åˆ° TourClock",
        "status_success_color": "#27AE60",
        "status_local": "æœ¬åœ°è¨­å®š",
        "status_local_color": "#F39C12",
        "reminder_info": "â° æ™ºèƒ½æé†’è¨­å®š",
        "reminder_details": "â€¢ é›†åˆå‰ 10 åˆ†é˜æé†’\nâ€¢ é›†åˆå‰ 5 åˆ†é˜æé†’\nâ€¢ é›†åˆæ™‚é–“åˆ°æé†’"
    },
    "help": {
        "title": "ğŸ“± TourHub åŠŸèƒ½ä»‹ç´¹",
        "color": "#6C5CE7",
        "features": [
            {
                "emoji": "ğŸ†",
                "name": "æ’è¡Œæ¦œ (Ranking List)",
                "description": "æä¾›å…¶ä»–ä½¿ç”¨è€…çš„è¡Œç¨‹è³‡è¨Šé€²è¡Œæ’è¡Œï¼Œå¹«åŠ©æ‚¨åšè¡Œç¨‹è¦åŠƒ"
            },
            {
                "emoji": "ğŸ—“ï¸",
                "name": "è¡Œç¨‹ç®¡ç† (Trip Management)",
                "description": "å»ºç«‹å±¬æ–¼æ‚¨çš„å°ˆå±¬è¡Œç¨‹å…§å®¹"
            },
            {
                "emoji": "ğŸ“",
                "name": "é›†åˆåŠŸèƒ½ (Meeting Point)",
                "description": "è¨­å®šé›†åˆåœ°é»ï¼Œæ–¹ä¾¿åˆ†æ•£æ´»å‹•å¾Œé‡æ–°é›†åˆ"
            },
            {
                "emoji": "ğŸ›…",
                "name": "ç½®ç‰©æ«ƒ (Locker)",
                "description": "å¿«é€Ÿå®šä½é™„è¿‘æœ‰ç©ºä½çš„ç½®ç‰©æ«ƒï¼Œè¼•é¬†å¯„å­˜è¡Œæ"
            },
            {
                "emoji": "ğŸ’°",
                "name": "åˆ†å¸³å·¥å…· (Split Bill)",
                "description": "è¨˜éŒ„æ¯ä¸€ç­†è²»ç”¨ï¼Œè‡ªå‹•è¨ˆç®—æ¯äººæ‡‰ä»˜é‡‘é¡"
            },
        ]
    }
}

# æ’è¡Œæ¦œæ•¸æ“šé…ç½®
LEADERBOARD_DATA = {
    "1": {
        "title": "ğŸ¥‡ æ’è¡Œæ¦œç¬¬ä¸€å",
        "color": "#FFD700",
        "destination": "æ±äº¬",
        "duration": "5å¤©4å¤œ",
        "participants": "4äºº",
        "feature": "ç¶“å…¸é—œæ±åœ°å€æ·±åº¦éŠ",
        "itinerary": "Day 1: æ·ºè‰å¯º â†’ æ™´ç©ºå¡” â†’ ç§‹è‘‰åŸ\nDay 2: æ˜æ²»ç¥å®® â†’ åŸå®¿ â†’ æ¾€è°·\nDay 3: æ–°å®¿ â†’ æ± è¢‹ â†’ éŠ€åº§\nDay 4: å°å ´ â†’ ç¯‰åœ°å¸‚å ´ â†’ æ±äº¬éµå¡”\nDay 5: ä¸Šé‡å…¬åœ’ â†’ é˜¿ç¾æ©«ç”º â†’ æ©Ÿå ´"
    },
    "2": {
        "title": "ğŸ¥ˆ æ’è¡Œæ¦œç¬¬äºŒå",
        "color": "#C0C0C0",
        "destination": "å¤§é˜ª",
        "duration": "4å¤©3å¤œ",
        "participants": "3äºº",
        "feature": "é—œè¥¿ç¾é£Ÿæ–‡åŒ–ä¹‹æ—…",
        "itinerary": "Day 1: å¤§é˜ªåŸ â†’ é“é “å € â†’ å¿ƒé½‹æ©‹\nDay 2: ç’°çƒå½±åŸä¸€æ—¥éŠ\nDay 3: å¤©ä¿å±±æ‘©å¤©è¼ª â†’ æµ·éŠé¤¨ â†’ æ¢…ç”°è—å¤©å¤§å»ˆ\nDay 4: é€šå¤©é–£ â†’ æ–°ä¸–ç•Œ â†’ æ©Ÿå ´"
    },
    "3": {
        "title": "ğŸ¥‰ æ’è¡Œæ¦œç¬¬ä¸‰å",
        "color": "#CD7F32",
        "destination": "äº¬éƒ½",
        "duration": "6å¤©5å¤œ",
        "participants": "2äºº",
        "feature": "å¤éƒ½æ–‡åŒ–æ·±åº¦é«”é©—",
        "itinerary": "Day 1: é‡‘é–£å¯º â†’ é¾å®‰å¯º â†’ äºŒæ¡åŸ\nDay 2: æ¸…æ°´å¯º â†’ åœ°ä¸»ç¥ç¤¾ â†’ ç¥‡åœ’\nDay 3: ä¼è¦‹ç¨»è·å¤§ç¤¾ â†’ æ±ç¦å¯º â†’ ä¸‰åä¸‰é–“å ‚\nDay 4: åµå±±ç«¹æ— â†’ å¤©é¾å¯º â†’ æ¸¡æœˆæ©‹\nDay 5: éŠ€é–£å¯º â†’ å“²å­¸ä¹‹é“ â†’ å—ç¦ªå¯º\nDay 6: è¥¿é™£ç¹”æœƒé¤¨ â†’ æ©Ÿå ´"
    },
    "4": {
        "title": "ğŸ… æ’è¡Œæ¦œç¬¬å››å",
        "color": "#4ECDC4",
        "destination": "æ²–ç¹©",
        "duration": "5å¤©4å¤œ",
        "participants": "5äºº",
        "feature": "æµ·å³¶åº¦å‡æ”¾é¬†ä¹‹æ—…",
        "itinerary": "Day 1: é¦–é‡ŒåŸ â†’ åœ‹éš›é€š â†’ ç‰§å¿—å…¬è¨­å¸‚å ´\nDay 2: ç¾éº—æµ·æ°´æ—é¤¨ â†’ å¤å®‡åˆ©å³¶ â†’ åè­·é³³æ¢¨åœ’\nDay 3: è¬åº§æ¯› â†’ çœŸæ¦®ç”°å²¬ â†’ æ®˜æ³¢å²¬\nDay 4: åº§å–œå‘³åŸè·¡ â†’ è®€è°·æ‘ â†’ åŒ—è°·ç”ºç¾åœ‹æ‘\nDay 5: ç€¨é•·å³¶ â†’ æ©Ÿå ´"
    },
    "5": {
        "title": "ğŸ–ï¸ æ’è¡Œæ¦œç¬¬äº”å",
        "color": "#FF6B9D",
        "destination": "åŒ—æµ·é“",
        "duration": "7å¤©6å¤œ",
        "participants": "6äºº",
        "feature": "åŒ—åœ‹é¢¨æƒ…æ·±åº¦æ¢ç´¢",
        "itinerary": "Day 1: æœ­å¹Œå¸‚å€ â†’ å¤§é€šå…¬åœ’ â†’ ç‹¸å°è·¯å•†åº—è¡—\nDay 2: å°æ¨½é‹æ²³ â†’ å°æ¨½éŸ³æ¨‚ç›’å ‚ â†’ åŒ—ä¸€ç¡å­\nDay 3: å‡½é¤¨å±±å¤œæ™¯ â†’ äº”ç¨œéƒ­å…¬åœ’ â†’ å…ƒç”ºç•°äººé¤¨\nDay 4: å¯Œè‰¯é‡è–°è¡£è‰ç”° â†’ ç¾ç‘›é’æ±  â†’ ç™½é‡‘æº«æ³‰\nDay 5: æ´çˆºæ¹– â†’ æ˜­å’Œæ–°å±± â†’ ç™»åˆ¥æº«æ³‰\nDay 6: æ—­å±±å‹•ç‰©åœ’ â†’ å±¤é›²å³½ â†’ å¤§é›ªå±±\nDay 7: æ©Ÿå ´"
    }
}

# é—œéµå­—æ˜ å°„é…ç½®
KEYWORD_MAPPINGS = {
    "leaderboard": {
        "keywords": ["æ’è¡Œæ¦œ", "æ’å", "æ’è¡Œ", "top", "Top", "leaderboard", "Leaderboard", "æ’åæ¦œ", "ç†±é–€", "ç†±é–€æ’è¡Œ"],
        "template": "feature",
        "feature_name": "leaderboard"
    },
    "leaderboard_1": {
        "keywords": ["æ’è¡Œæ¦œç¬¬ä¸€", "æ’è¡Œç¬¬ä¸€", "ç¬¬ä¸€å", "top1", "Top1", "å† è»", "æ’è¡Œæ¦œå† è»", "æ’è¡Œæ¦œç¬¬ä¸€å"],
        "template": "leaderboard",
        "rank": "1"
    },
    "leaderboard_2": {
        "keywords": ["ç¬¬äºŒå", "æ’è¡Œç¬¬äºŒ", "top2", "Top2", "äºè»", "æ’è¡Œæ¦œäºè»", "æ’è¡Œæ¦œç¬¬äºŒå"],
        "template": "leaderboard",
        "rank": "2"
    },
    "leaderboard_3": {
        "keywords": ["ç¬¬ä¸‰å", "æ’è¡Œç¬¬ä¸‰", "top3", "Top3", "å­£è»", "æ’è¡Œæ¦œå­£è»", "æ’è¡Œæ¦œç¬¬ä¸‰å"],
        "template": "leaderboard",
        "rank": "3"
    },
    "leaderboard_4": {
        "keywords": ["ç¬¬å››å", "æ’è¡Œç¬¬å››", "top4", "Top4", "æ’è¡Œæ¦œç¬¬å››å"],
        "template": "leaderboard",
        "rank": "4"
    },
    "leaderboard_5": {
        "keywords": ["ç¬¬äº”å", "æ’è¡Œç¬¬äº”", "top5", "Top5", "æ’è¡Œæ¦œç¬¬äº”å"],
        "template": "leaderboard",
        "rank": "5"
    },
    "trip_management": {
        "keywords": ["è¡Œç¨‹ç®¡ç†", "è¡Œç¨‹", "æ—…éŠ", "æ—…è¡Œ", "è¦åŠƒ", "è¨ˆåŠƒ", "è¡Œç¨‹è¦åŠƒ", "æ—…éŠè¦åŠƒ", "trip", "Trip", "travel", "Travel", "schedule", "Schedule", "plan", "Plan", "è¡Œç¨‹è¡¨", "æ—…éŠè¡Œç¨‹"],
        "template": "feature",
        "feature_name": "trip_management"
    },
    "locker": {
        "keywords": ["ç½®ç‰©æ«ƒ", "å¯„ç‰©é»", "è¡Œæå¯„å­˜", "å¯„ç‰©", "ç½®ç‰©", "locker", "Locker"],
        "template": "feature",
        "feature_name": "locker"
    },
    "split_bill": {
        "keywords": ["åˆ†å¸³", "AA", "å¹³åˆ†", "å‡åˆ†", "åˆ†éŒ¢", "ç®—å¸³", "çµå¸³", "ä»˜æ¬¾", "ä»˜éŒ¢", "share", "Share", "split", "Split"],
        "template": "feature",
        "feature_name": "split_bill"
    },
    "tourclock": {
        "keywords": ["é›†åˆ", "é›†åˆé»", "é›†åˆåœ°é»", "é›†åˆæ™‚é–“", "meeting", "Meeting", "meet", "Meet", "gather", "Gather", "é›†åˆç®¡ç†", "æ™‚é–“ç®¡ç†", "æé†’", "tourclock", "TourClock", "Tourclock"],
        "template": "feature",
        "feature_name": "tourclock"
    },
    "help": {
        "keywords": ["åŠŸèƒ½ä»‹ç´¹", "åŠŸèƒ½", "ä»‹ç´¹", "èªªæ˜", "help", "Help", "åŠŸèƒ½èªªæ˜", "ä½¿ç”¨èªªæ˜","TourhubåŠŸèƒ½ä»‹ç´¹","TourhubåŠŸèƒ½","Tourhubä»‹ç´¹","Tourhubèªªæ˜"],
        "template": "help"
    }
}

# é›†åˆåœ°é»é…ç½®
MEETING_LOCATIONS = [
    "æ±äº¬éµå¡”", "æ·ºè‰å¯º", "æ–°å®¿è»Šç«™", "æ¾€è°·", "éŠ€åº§", "ç§‹è‘‰åŸ", "åŸå®¿", "æ± è¢‹", "å°å ´", "ç¯‰åœ°å¸‚å ´", 
    "ä¸Šé‡å…¬åœ’", "é˜¿ç¾æ©«ç”º", "å¤§é˜ªåŸ", "é“é “å €", "å¿ƒé½‹æ©‹", "ç’°çƒå½±åŸ", "å¤©ä¿å±±", "æµ·éŠé¤¨", "æ¢…ç”°", 
    "é€šå¤©é–£", "æ–°ä¸–ç•Œ", "é‡‘é–£å¯º", "é¾å®‰å¯º", "äºŒæ¡åŸ", "æ¸…æ°´å¯º", "åœ°ä¸»ç¥ç¤¾", "ç¥‡åœ’", "ä¼è¦‹ç¨»è·å¤§ç¤¾", 
    "æ±ç¦å¯º", "ä¸‰åä¸‰é–“å ‚", "åµå±±", "å¤©é¾å¯º", "æ¸¡æœˆæ©‹", "éŠ€é–£å¯º", "å“²å­¸ä¹‹é“", "å—ç¦ªå¯º", "è¥¿é™£ç¹”æœƒé¤¨", 
    "é¦–é‡ŒåŸ", "åœ‹éš›é€š", "ç‰§å¿—å…¬è¨­å¸‚å ´", "ç¾éº—æµ·æ°´æ—é¤¨", "å¤å®‡åˆ©å³¶", "åè­·é³³æ¢¨åœ’", "è¬åº§æ¯›", "çœŸæ¦®ç”°å²¬", 
    "æ®˜æ³¢å²¬", "åº§å–œå‘³åŸè·¡", "è®€è°·æ‘", "åŒ—è°·ç”ºç¾åœ‹æ‘", "ç€¨é•·å³¶", "æœ­å¹Œ", "å¤§é€šå…¬åœ’", "ç‹¸å°è·¯å•†åº—è¡—", 
    "å°æ¨½é‹æ²³", "å°æ¨½éŸ³æ¨‚ç›’å ‚", "åŒ—ä¸€ç¡å­", "å‡½é¤¨å±±", "äº”ç¨œéƒ­å…¬åœ’", "å…ƒç”ºç•°äººé¤¨", "å¯Œè‰¯é‡", "ç¾ç‘›é’æ± ", 
    "ç™½é‡‘æº«æ³‰", "æ´çˆºæ¹–", "æ˜­å’Œæ–°å±±", "ç™»åˆ¥æº«æ³‰", "æ—­å±±å‹•ç‰©åœ’", "å±¤é›²å³½", "å¤§é›ªå±±"
]

# æ™‚é–“è§£ææ¨¡å¼
TIME_PATTERNS = {
    "standard": r'(\d{1,2}:\d{2})',
    "chinese": r'(\d{1,2})é»(\d{1,2})åˆ†',
    "simple_chinese": r'(\d{1,2})é»',
    "am_pm": r'(ä¸Šåˆ|ä¸‹åˆ|æ™šä¸Š|å‡Œæ™¨)\s*(\d{1,2})[é»:](\d{1,2})?'
}

# é›†åˆæ™‚é–“æ¨¡å¼
MEETING_TIME_PATTERN = r'é›†åˆ.*æ™‚é–“|æ™‚é–“.*é›†åˆ|é›†åˆ.*\d{1,2}:\d{2}|æ˜å¤©.*é›†åˆ|ä»Šå¤©.*é›†åˆ|ä¸‹åˆ.*é›†åˆ|ä¸Šåˆ.*é›†åˆ|æ™šä¸Š.*é›†åˆ|å‡Œæ™¨.*é›†åˆ|é›†åˆ.*ä¸‹åˆ|é›†åˆ.*ä¸Šåˆ|é›†åˆ.*æ™šä¸Š|é›†åˆ.*å‡Œæ™¨|\d{1,2}:\d{2}.*é›†åˆ|\d{1,2}é»\d{1,2}åˆ†.*é›†åˆ|\d{1,2}é».*é›†åˆ'

# è¡Œç¨‹è³‡æ–™åº«å·²ç§»é™¤ï¼Œæ”¹ç‚ºå¾è³‡æ–™åº«å‹•æ…‹ç²å– 